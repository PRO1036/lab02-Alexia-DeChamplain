---
title: "Lab 02 - Plastic waste"
author: Alexia De Champlain
date: 17 septembre 2025
output: github_document
---

## Chargement des packages et des données

```{r load-packages, message=FALSE}
library(tidyverse) 
```

```{r load-data, message=FALSE}
plastic_waste <- read_csv("data/plastic-waste.csv")
```

Commençons par filtrer les données pour retirer le point représenté par Trinité et Tobago (TTO) qui est un outlier.

```{r filter-data, message=FALSE}
plastic_waste <- plastic_waste %>%
  filter(plastic_waste_per_cap < 3.5)
```

## Exercices

### Exercise 1

```{r plastic-waste-continent}
ggplot(data = plastic_waste, aes(x = plastic_waste_per_cap)) +
  geom_histogram(binwidth = 0.2) +
  facet_wrap( ~ continent) +
  labs( title = "La distribution des quantités de déchets 
        plastiques par habitant", subtitle = "Selon le continent", x = "Quantité de déchets plastiques par habitant", y = "Distribution")
```

Certains continents ont des habitants qui produisent plus de déchets que d'autres. Par exemple, les continents de l'Amérique du Nord, de l'Asie et de l'Europe sont les plus grands producteurs de déchets. De plus, l'Océanie et l'Amérique du Sud en produisent moins que les autres continents. L'Afrique produit le moins de déchets. En effet, pour le premier groupe, la majorité des habitants produisent de 0,00 à 0,25 kg/jour, alors que d'autres en produisent plus de 0,25 kg/jour. Pour le groupe de l'Océanie et de l'Amérique du Sud, la majorité des habitants produisent entre 0,00 et 0,25 kg/jour, alors qu'une petite quantité d'habitants de l'Amérique du Sud en produisent plus de 0,50 kg/jour, comparé à un maximum de 0,50 kg/jour pour l'Océanie. Finalement, pour l'Afrique, presque tous les habitants produisent de 0,00 à 0,25 kg/jour.

### Exercise 2

```{r plastic-waste-density}
ggplot(plastic_waste, aes(x = plastic_waste_per_cap)) +
  geom_density(adjust = 1) +
  labs( title = "La quantité de déchets plastiques par habitant", x = "Quantité de déchets plastiques par habitant", y = "Densité")

ggplot(plastic_waste, aes(x = plastic_waste_per_cap, color = continent)) + 
  geom_density(adjust = 1) + labs( title = "La quantité de déchets plastiques par habitant", subtitle = "Selon le continent", x = "Quantité de déchets plastiques par habitant", y = "Densité", color = "Continent")

ggplot(plastic_waste, aes(x = plastic_waste_per_cap, color = continent, fill = continent)) + 
  geom_density(adjust = 1) + labs( title = "La quantité de déchets plastiques par habitant", subtitle = "Selon le continent", x = "Quantité de déchets plastiques par habitant", y = "Densité", color = "Continent", fill = "Continent")

ggplot(plastic_waste, aes(x = plastic_waste_per_cap, color = continent, fill = continent)) + 
  geom_density(adjust = 1, alpha = 0.4) + labs( title = "La quantité de déchets plastiques par habitant", subtitle = "Selon le continent", x = "Quantité de déchets plastiques par habitant", y = "Densité", color = "Continent", fill = "Continent")
```

Car aes est dépendant des données, alors que les réglages écrits dans geom_density() restent constants pour toutes les données.

### Exercise 3

Boxplot:

```{r plastic-waste-boxplot}
ggplot(plastic_waste, aes(x = continent, y = plastic_waste_per_cap)) +
  geom_boxplot() +
  labs( title = "La quantité de déchets plastiques par habitant selon le continent", x = "Continent", y = "Quantité de déchets plastiques par habitant")
```

Violin plot:

```{r plastic-waste-violin}
ggplot(plastic_waste, aes(x = continent, y = plastic_waste_per_cap)) +
  geom_violin() +
  labs( title = "La quantité de déchets plastiques par habitant selon le continent", x = "Continent", y = "Quantité de déchets plastiques par habitant")
```

Les violin plots permettent de voir la répartition des valeurs ou l'estimation de la densité, ce que les boxplots ne permettent pas.

### Exercise 4


```{r plastic-waste-mismanaged}
ggplot(plastic_waste, aes(x = plastic_waste_per_cap, y = mismanaged_plastic_waste_per_cap, color = continent)) + geom_point() +
  labs( title = "La quantité de déchets plastiques par habitant selon la quantité de déchets non gérés par habitant", subtitle = "Selon le continent", x = "Quantité de déchets plastiques par habitant", y = "Quantité de déchets non gérés par habitant", color = "Continent")
```

En général, on peut observer une relation linéaire pour chaque continent. En effet, quand la valeur de x augmente pour une donnée, elle augmente aussi en y. Pour l'Afrique, on peut observer que les habitants produisent moins de déchets, mais qu'ils ne les gèrent pas bien non plus. Ensuite, pour l'Asie, on voit qu'ils produisent beaucoup de déchets et qu'ils ne les gèrent pas bien non plus. Pour l'Europe, elle semble quand même bien gérer ses déchets, puisqu'ils en produisent beaucoup, mais que les valeurs en y sont peu élevées. Pour l'Amérique du Nord, les valeurs sont plus dispersées dans le graphique, de sorte que les valeurs en x et en y sont élevés, donc qu'ils produisent beaucoup et les gèrent mal. De son côté, l'Océanie produisent une quantité moyenne de déchets, mais les gèrent mal aussi. Même chose aussi pour l'Amérique du Sud.

### Exercise 5

```{r plastic-waste-population-total}
ggplot(plastic_waste, aes(x = plastic_waste_per_cap, y = total_pop)) +
  geom_point() + 
  labs( title = "La quantité de déchets plastiques par habitant selon la population totale", x = "Quantité de déchets plastiques par habitant", y = "Population totale")

ggplot(plastic_waste, aes(x = plastic_waste_per_cap, y = coastal_pop)) +
  geom_point() + 
  labs( title = "La quantité de déchets plastiques par habitant selon la population côtière", x = "Quantité de déchets plastiques par habitant", y = "Population côtière")
```

Les deux relations sont semblables. Il est difficile de confirmer à l'oeil nu si la tendance est plus forte dans un ou l'autre dans la graphique. La seule différence notable est que les données du deuxième graphique ont des valeurs en y plus élevées entre x = 0,0 et 0,2.

## Conclusion

Recréez la visualisation:

```{r recreate-viz}
plastic_waste_coastal <- plastic_waste %>% 
  mutate(coastal_pop_prop = coastal_pop / total_pop) %>%
  filter(plastic_waste_per_cap < 3)

ggplot(plastic_waste_coastal, aes(x = coastal_pop_prop, y = plastic_waste_per_cap, color = continent)) +
  geom_point() +
  geom_smooth(method = "loess", color = "black") +
  labs( title = "Quantité de déchets plastiques vs Proportion de la population côtière", subtitle = "Selon le continent", x = "Proportion de la population côtière (Coastal / total population)", y = "Nombre de déchets plastiques par habitant", color = "Continent")
```

La relation n'est pas linéaire, elle monte au début, avant de se stabiliser au milieu, pour finir en diminuant. Il existe aussi une forte dispersion des points. De plus, la zone grise représente l'incertitude de la tendance en noir. Comme elle s'élargit aux extrémités, cela indique une diminution des données, donc de la fiabilité de la tendance.

